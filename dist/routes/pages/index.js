"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var express_1 = __importDefault(require("express"));
var router = express_1.default.Router();
var admin_1 = __importDefault(require("./modules/admin"));
var oauth_1 = __importDefault(require("./modules/oauth"));
var store_controller_1 = __importDefault(require("../../controllers/pages/store-controller"));
var user_controller_1 = __importDefault(require("../../controllers/pages/user-controller"));
var passport_1 = __importDefault(require("../../config/passport"));
var auth_1 = require("../../middlewares/auth");
var error_handler_1 = require("../../middlewares/error-handler");
var multer_1 = __importDefault(require("../../middlewares/multer"));
router.get('/signup', user_controller_1.default.signUpPage);
router.post('/signup', user_controller_1.default.signUp);
router.get('/signin', user_controller_1.default.signInPage);
router.post('/signin', passport_1.default.authenticate('local', { failureRedirect: '/signin', failureFlash: true }), user_controller_1.default.signIn);
router.get('/logout', user_controller_1.default.logOut);
router.get('/users/:id', auth_1.authenticated, user_controller_1.default.getUser);
router.get('/users/:id/edit', auth_1.authenticated, user_controller_1.default.editUser);
router.put('/users/:id', auth_1.authenticated, multer_1.default.single('avatar'), user_controller_1.default.putUser);
router.put('/avatars/:userId', auth_1.authenticated, user_controller_1.default.putAvatar);
router.get('/carts', auth_1.authenticated, user_controller_1.default.getCarts);
router.post('/carts/:storeId', auth_1.authenticated, user_controller_1.default.addCart);
router.delete('/carts/:cartId', auth_1.authenticated, user_controller_1.default.removeCart);
router.get('/orders', auth_1.authenticated, user_controller_1.default.getOrders);
router.post('/orders/all', auth_1.authenticated, user_controller_1.default.addOrders);
router.get('/stores', auth_1.authenticated, store_controller_1.default.getStores);
router.get('/stores/:id', auth_1.authenticated, store_controller_1.default.getStore);
router.use('/admin', auth_1.authenticatedAdmin, admin_1.default);
router.use('/', oauth_1.default);
router.use('/', function (req, res) { return res.redirect('/stores'); });
router.use('/', error_handler_1.generalErrorHandler);
exports.default = router;
